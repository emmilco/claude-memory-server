[pytest]
# Pytest configuration for CI/CD compatibility

markers =
    unit: Fast isolated unit tests with no external dependencies (auto-applied to tests/unit/)
    integration: Integration tests requiring external services like Qdrant (auto-applied to tests/integration/)
    e2e: End-to-end tests covering full workflows
    slow: Tests taking >1 second (deselect with '-m "not slow"')
    smoke: Critical path tests that must pass for basic functionality
    requires_docker: Tests requiring Docker containers
    requires_gpu: Tests requiring GPU hardware
    no_parallel: Tests that cannot run in parallel (file system conflicts, global state, ports)
    security: Security-focused tests (auto-applied to tests/security/)
    skip_ci: marks tests to skip in CI environments (timing/env-sensitive)
    benchmark: marks tests as benchmarks for performance measurement
    serial: marks tests that must run serially (not safe for parallel execution)

# Exclude manual test scripts (meant to be run standalone, not via pytest)
norecursedirs = .git .worktrees __pycache__ .pytest_cache tests/manual

# Skip CI-sensitive tests when running in GitHub Actions
addopts =
    --strict-markers
    -v

# Parallel test execution (Phase 3 optimization)
# Uncomment to enable by default, or use: pytest -n auto
# Note: Tests marked with @pytest.mark.serial will still run serially
# addopts = -n auto
