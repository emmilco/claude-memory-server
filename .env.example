# Claude Memory RAG Server - Environment Configuration
# ==================================================
# Copy this file to .env and customize for your needs
#
# Configuration Priority:
#   1. Environment variables (CLAUDE_RAG_*)
#   2. User config file (~/.claude-rag/config.json)
#   3. Built-in defaults (shown below)
#
# All variables must be prefixed with CLAUDE_RAG_
# Example: CLAUDE_RAG_STORAGE_BACKEND=qdrant


# =============================================================================
# CORE SETTINGS
# =============================================================================

# Server identification name
#CLAUDE_RAG_SERVER_NAME=claude-memory-rag

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
#CLAUDE_RAG_LOG_LEVEL=INFO


# =============================================================================
# STORAGE BACKEND
# =============================================================================

# Storage backend: "sqlite" (easier setup) or "qdrant" (better performance)
# SQLite: Good for <10k memories, no Docker required
# Qdrant: Recommended for >10k memories, requires Docker
#CLAUDE_RAG_STORAGE_BACKEND=sqlite

# Qdrant connection (only used if storage_backend=qdrant)
#CLAUDE_RAG_QDRANT_URL=http://localhost:6333
#CLAUDE_RAG_QDRANT_API_KEY=
#CLAUDE_RAG_QDRANT_COLLECTION_NAME=memory

# SQLite database path (only used if storage_backend=sqlite)
#CLAUDE_RAG_SQLITE_PATH=~/.claude-rag/memory.db


# =============================================================================
# EMBEDDING CONFIGURATION
# =============================================================================

# Embedding model (sentence-transformers format)
#CLAUDE_RAG_EMBEDDING_MODEL=all-MiniLM-L6-v2

# Enable embedding cache for faster re-indexing (98% cache hit rate)
#CLAUDE_RAG_EMBEDDING_CACHE_ENABLED=true
#CLAUDE_RAG_EMBEDDING_CACHE_PATH=~/.claude-rag/embedding_cache.db
#CLAUDE_RAG_EMBEDDING_CACHE_TTL_DAYS=30

# Parallel embedding generation (4-8x faster indexing)
# Set to false if experiencing memory issues
#CLAUDE_RAG_ENABLE_PARALLEL_EMBEDDINGS=true

# Number of worker processes (auto-detects CPU count if not set)
#CLAUDE_RAG_EMBEDDING_PARALLEL_WORKERS=

# Batch size for embedding generation (1-256)
#CLAUDE_RAG_EMBEDDING_BATCH_SIZE=32


# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Maximum context tokens for query processing
#CLAUDE_RAG_MAX_QUERY_CONTEXT_TOKENS=8000

# Retrieval timeout in milliseconds (100-30000)
#CLAUDE_RAG_RETRIEVAL_TIMEOUT_MS=500


# =============================================================================
# SECURITY
# =============================================================================

# Enable read-only mode (prevents writes)
#CLAUDE_RAG_READ_ONLY_MODE=false

# Enable input validation (recommended: true)
#CLAUDE_RAG_ENABLE_INPUT_VALIDATION=true

# Maximum memory size in bytes (prevents abuse)
#CLAUDE_RAG_MAX_MEMORY_SIZE_BYTES=10240


# =============================================================================
# CODE INDEXING & FILE WATCHING
# =============================================================================

# Enable automatic file watching and re-indexing
#CLAUDE_RAG_ENABLE_FILE_WATCHER=true

# Debounce delay for file changes in milliseconds
#CLAUDE_RAG_WATCH_DEBOUNCE_MS=1000


# =============================================================================
# GRACEFUL DEGRADATION
# =============================================================================

# Fall back to SQLite if Qdrant is unavailable
#CLAUDE_RAG_ALLOW_QDRANT_FALLBACK=true

# Fall back to Python parser if Rust parser unavailable
#CLAUDE_RAG_ALLOW_RUST_FALLBACK=true

# Show warnings when running in degraded mode
#CLAUDE_RAG_WARN_ON_DEGRADATION=true


# =============================================================================
# ADAPTIVE RETRIEVAL
# =============================================================================

# Enable retrieval gate (filters low-utility queries)
#CLAUDE_RAG_ENABLE_RETRIEVAL_GATE=true

# Relevance threshold for retrieval (0.0-1.0)
# Lower = more results, Higher = more precise
#CLAUDE_RAG_RETRIEVAL_GATE_THRESHOLD=0.6


# =============================================================================
# MEMORY PRUNING & LIFECYCLE
# =============================================================================

# Time-to-live for session state memories (hours)
#CLAUDE_RAG_SESSION_STATE_TTL_HOURS=48

# Enable automatic memory pruning
#CLAUDE_RAG_ENABLE_AUTO_PRUNING=true

# Pruning schedule (cron format: "minute hour day month weekday")
# Default: 2 AM daily
#CLAUDE_RAG_PRUNING_SCHEDULE=0 2 * * *


# =============================================================================
# USAGE TRACKING & ANALYTICS
# =============================================================================

# Track memory access patterns for better ranking
#CLAUDE_RAG_ENABLE_USAGE_TRACKING=true

# Batch size for usage updates
#CLAUDE_RAG_USAGE_BATCH_SIZE=100

# Flush interval for usage updates (seconds)
#CLAUDE_RAG_USAGE_FLUSH_INTERVAL_SECONDS=60


# =============================================================================
# RANKING WEIGHTS
# =============================================================================
# These weights determine how memories are ranked in search results
# MUST sum to 1.0

# Weight for semantic similarity (0.0-1.0)
#CLAUDE_RAG_RANKING_WEIGHT_SIMILARITY=0.6

# Weight for recency (0.0-1.0)
#CLAUDE_RAG_RANKING_WEIGHT_RECENCY=0.2

# Weight for usage frequency (0.0-1.0)
#CLAUDE_RAG_RANKING_WEIGHT_USAGE=0.2

# Recency decay half-life in days
# Memories lose half their recency weight after this period
#CLAUDE_RAG_RECENCY_DECAY_HALFLIFE_DAYS=7.0


# =============================================================================
# CONVERSATION TRACKING
# =============================================================================

# Enable conversation context tracking
#CLAUDE_RAG_ENABLE_CONVERSATION_TRACKING=true

# Session timeout in minutes
#CLAUDE_RAG_CONVERSATION_SESSION_TIMEOUT_MINUTES=30

# Number of recent queries to track per conversation
#CLAUDE_RAG_CONVERSATION_QUERY_HISTORY_SIZE=5

# Similarity threshold for query expansion (0.0-1.0)
#CLAUDE_RAG_QUERY_EXPANSION_SIMILARITY_THRESHOLD=0.7

# Fetch multiplier for deduplication (1-10)
#CLAUDE_RAG_DEDUPLICATION_FETCH_MULTIPLIER=3


# =============================================================================
# QUERY EXPANSION (FEAT-024)
# =============================================================================

# Enable automatic query expansion with synonyms
#CLAUDE_RAG_ENABLE_QUERY_EXPANSION=true

# Use programming term synonyms (e.g., "function" â†’ "method")
#CLAUDE_RAG_QUERY_EXPANSION_SYNONYMS=true

# Use code domain context patterns
#CLAUDE_RAG_QUERY_EXPANSION_CODE_CONTEXT=true

# Maximum synonyms per term
#CLAUDE_RAG_QUERY_EXPANSION_MAX_SYNONYMS=2

# Maximum context terms to add
#CLAUDE_RAG_QUERY_EXPANSION_MAX_CONTEXT_TERMS=3


# =============================================================================
# GIT HISTORY INDEXING
# =============================================================================

# Enable git commit history indexing
#CLAUDE_RAG_ENABLE_GIT_INDEXING=true

# Number of commits to index (1-100000)
#CLAUDE_RAG_GIT_INDEX_COMMIT_COUNT=1000

# Branches to index: "current" or "all"
#CLAUDE_RAG_GIT_INDEX_BRANCHES=current

# Index git tags
#CLAUDE_RAG_GIT_INDEX_TAGS=true

# Index git diffs (auto-disabled for large repos)
#CLAUDE_RAG_GIT_INDEX_DIFFS=true

# Auto-disable diffs for repos larger than this (MB)
#CLAUDE_RAG_GIT_AUTO_SIZE_THRESHOLD_MB=500

# Skip individual diffs larger than this (KB)
#CLAUDE_RAG_GIT_DIFF_SIZE_LIMIT_KB=10


# =============================================================================
# HYBRID SEARCH (BM25 + Vector)
# =============================================================================

# Enable hybrid search (keyword + semantic)
#CLAUDE_RAG_ENABLE_HYBRID_SEARCH=true

# Search weight: 0=keyword only, 1=semantic only, 0.5=balanced
#CLAUDE_RAG_HYBRID_SEARCH_ALPHA=0.5

# Fusion method: "weighted", "rrf" (reciprocal rank fusion), or "cascade"
#CLAUDE_RAG_HYBRID_FUSION_METHOD=weighted

# BM25 term saturation parameter
#CLAUDE_RAG_BM25_K1=1.5

# BM25 length normalization parameter
#CLAUDE_RAG_BM25_B=0.75


# =============================================================================
# CROSS-PROJECT LEARNING (FEAT-030)
# =============================================================================

# Allow searching across multiple projects
#CLAUDE_RAG_ENABLE_CROSS_PROJECT_SEARCH=true

# Default search mode: "current" (single project) or "all" (cross-project)
#CLAUDE_RAG_CROSS_PROJECT_DEFAULT_MODE=current

# Consent file location for cross-project opt-in
#CLAUDE_RAG_CROSS_PROJECT_OPT_IN_FILE=~/.claude-rag/cross_project_consent.json


# =============================================================================
# MULTI-REPOSITORY SUPPORT (FEAT-017)
# =============================================================================

# Enable multi-repository features
#CLAUDE_RAG_ENABLE_MULTI_REPOSITORY=true

# Maximum parallel repository operations
#CLAUDE_RAG_MULTI_REPO_MAX_PARALLEL=3

# Repository metadata storage path
#CLAUDE_RAG_REPOSITORY_STORAGE_PATH=~/.claude-rag/repositories.json

# Workspace metadata storage path
#CLAUDE_RAG_WORKSPACE_STORAGE_PATH=~/.claude-rag/workspaces.json


# =============================================================================
# PROACTIVE CONTEXT SUGGESTIONS (FEAT-028)
# =============================================================================

# Enable proactive context pattern analysis
#CLAUDE_RAG_ENABLE_PROACTIVE_SUGGESTIONS=true

# Confidence threshold for auto-injection (0.0-1.0)
# Higher = fewer but more confident suggestions
#CLAUDE_RAG_PROACTIVE_SUGGESTIONS_THRESHOLD=0.90


# =============================================================================
# COMMON CONFIGURATION EXAMPLES
# =============================================================================

# Example 1: Minimal Setup (No Docker, Slower)
# CLAUDE_RAG_STORAGE_BACKEND=sqlite
# CLAUDE_RAG_ENABLE_PARALLEL_EMBEDDINGS=false
# CLAUDE_RAG_ALLOW_RUST_FALLBACK=true

# Example 2: Standard Setup (Docker, Good Performance)
# CLAUDE_RAG_STORAGE_BACKEND=qdrant
# CLAUDE_RAG_QDRANT_URL=http://localhost:6333
# CLAUDE_RAG_ENABLE_PARALLEL_EMBEDDINGS=true

# Example 3: High-Performance Setup
# CLAUDE_RAG_STORAGE_BACKEND=qdrant
# CLAUDE_RAG_ENABLE_PARALLEL_EMBEDDINGS=true
# CLAUDE_RAG_EMBEDDING_PARALLEL_WORKERS=8
# CLAUDE_RAG_EMBEDDING_BATCH_SIZE=64
# CLAUDE_RAG_ENABLE_HYBRID_SEARCH=true

# Example 4: Development/Testing
# CLAUDE_RAG_LOG_LEVEL=DEBUG
# CLAUDE_RAG_STORAGE_BACKEND=sqlite
# CLAUDE_RAG_ENABLE_FILE_WATCHER=false
# CLAUDE_RAG_ENABLE_AUTO_PRUNING=false
